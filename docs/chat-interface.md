# Maestro聊天界面文档

## 简介

Maestro聊天界面是类似Claude的AI对话页面，提供了友好的用户体验和完整的对话管理功能。用户可以创建、管理多个对话，在界面中与AI助手进行交互。

## 核心功能

### 1. 对话管理
- 创建新对话
- 切换历史对话
- 编辑对话标题
- 删除对话
- 对话自动保存

### 2. 消息交互
- 发送文本消息
- 接收AI回复
- 消息自动滚动
- 支持Ctrl+Enter快捷发送

### 3. 界面布局
- 可折叠侧边栏，提升空间利用率
- 响应式设计，适配移动端和桌面端
- 支持浅色/深色主题

## 技术实现

### 状态管理

使用Zustand管理对话和消息状态：

```typescript
// 消息类型
export interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: number;
}

// 对话类型
export interface Conversation {
  id: string;
  title: string;
  messages: Message[];
  createdAt: number;
  updatedAt: number;
}
```

主要状态函数：
- `createConversation`: 创建新对话
- `addMessage`: 添加消息到当前对话
- `setActiveConversation`: 设置活动对话
- `deleteConversation`: 删除对话
- `updateConversationTitle`: 更新对话标题

### 组件结构

```
└── AppLayout                     # 应用主布局
    ├── ChatSidebar               # 侧边栏
    │   ├── 新对话按钮
    │   ├── 对话历史列表
    │   └── 用户信息区域
    └── ChatContainer             # 对话容器
        ├── ChatHeader            # 对话标题栏
        ├── MessageList           # 消息列表
        │   └── MessageItem       # 单条消息
        └── ChatInput             # 消息输入框
```

## 使用说明

### 开始新对话
1. 点击侧边栏"新对话"按钮
2. 或直接在输入框输入并发送消息（如无活动对话会自动创建）

### 管理对话
1. 选择：点击侧边栏对话列表中的对话切换
2. 编辑标题：点击标题栏的编辑图标修改标题
3. 删除：在对话列表中点击对话右侧的删除图标

### 发送消息
1. 在底部输入框输入文本
2. 点击发送按钮或使用Ctrl+Enter (Cmd+Enter) 快捷键发送

## 实现细节

### 自适应布局

侧边栏根据屏幕尺寸自动调整：
- 桌面端：可展开/折叠的固定侧边栏
- 移动端：可滑出的浮动侧边栏，点击主内容区域自动隐藏

### 消息处理流程

1. 用户输入消息
2. 消息添加到状态管理
3. 向AI服务发送请求（当前为模拟）
4. 接收响应并添加到对话
5. 自动滚动到最新消息

### 用户友好功能

- 输入框自动调整高度
- 消息时间戳显示
- 加载状态指示
- 空状态引导提示
- 对话标题自动生成（基于首条消息）

## 后续改进

1. **集成实际AI服务**
   - 替换模拟响应为实际API调用
   - 添加流式响应支持

2. **增强功能**
   - 消息引用和编辑
   - 文件和图片上传
   - 多模态交互（语音、图像）
   - 代码高亮和格式化

3. **性能优化**
   - 长对话的虚拟滚动
   - 消息的懒加载
   - 状态缓存优化

4. **安全增强**
   - 敏感信息过滤
   - 内容安全提示
   - 用户权限控制 